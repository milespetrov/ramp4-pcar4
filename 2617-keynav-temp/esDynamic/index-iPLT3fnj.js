import{c_ as _,d1 as n,c$ as c,dO as $,dP as k,e1 as z,iG as E,dT as T,ea as y,dX as A,d0 as m,d$ as v,e2 as Z,ff as h,eb as f,dS as C,e0 as w,dY as O,dW as b,iE as F,dZ as M,fh as x,r as P,e6 as Y,e7 as j,dU as N,dV as B,e9 as S,F as G,dG as W}from"./main-CZ1ZHN9A.js";import{u as q}from"./draw-store-Banj_rPE.js";const D={},U={class:"border-b p-0 self-center w-2/3"};function X(g,a){return n(),c("span",U)}const L=_(D,[["render",X]]),J=$({__name:"zoom-nav",setup(g){const{t:a}=k(),t=z("iApi"),e=E(400,!0,()=>t.geo.map.zoomIn()),o=E(400,!0,()=>t.geo.map.zoomOut());return(s,r)=>{const l=T("mapnav-button");return n(),c("div",null,[y(l,{onClickFunction:v(e),tooltip:v(a)("mapnav.zoomIn")},{default:A(()=>r[0]||(r[0]=[m("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",class:"fill-current w-32 h-20"},[m("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),m("path",{d:"M0 0h24v24H0z",fill:"none"})],-1)])),_:1},8,["onClickFunction","tooltip"]),y(L),y(l,{onClickFunction:v(o),tooltip:v(a)("mapnav.zoomOut")},{default:A(()=>r[1]||(r[1]=[m("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",class:"fill-current w-32 h-20"},[m("path",{d:"M19 13H5v-2h14v2z"}),m("path",{d:"M0 0h24v24H0z",fill:"none"})],-1)])),_:1},8,["onClickFunction","tooltip"])])}}}),K=$({__name:"draw-nav-section",setup(g){const a=z("iApi"),{t}=k(),e=q();e.mapNavEl=Z("mapNavEl");const o=[{type:"point",icon:h(f(()=>import("./point-icon-H8FMDzZg.js")))},{type:"polyline",icon:h(f(()=>import("./polyline-icon-D3QXeUpR.js")))},{type:"polygon",icon:h(f(()=>import("./polygon-icon-5W75RMVc.js")))},{type:"circle",icon:h(f(()=>import("./circle-icon-CuAP7fK5.js")))},{type:"rectangle",icon:h(f(()=>import("./rectangle-icon-Ck3XAfev.js")))}],s=C(()=>{const p=o.filter(i=>e.supportedTypes.some(u=>u.type===i.type));return p.push({type:"edit",icon:h(f(()=>import("./edit-icon-DAX4EVvH.js")))}),p}),r=p=>{e.activeTool===p?e.setActiveTool(null):e.setActiveTool(p)},l=()=>{a.geo.map.setMouseFocus()};return(p,i)=>{const u=T("mapnav-button");return n(),c("div",{class:M([{active:v(e).activeTool||v(e).activeTool==""},"mapnav-section bg-white-75 hover:bg-white"])},[(n(!0),c(w,null,O(s.value,d=>(n(),b(u,{key:d.type,onMousedown:l,onClickFunction:()=>r(d.type),tooltip:v(t)(`draw.${d.type}.tooltip`),class:M({"active-tool":v(e).activeTool===d.type}),ref_for:!0,ref:"mapNavEl"},{default:A(()=>[(n(),b(F(d.icon),{class:"fill-current w-32 h-20"}))]),_:2},1032,["onClickFunction","tooltip","class"]))),128))],2)}}}),Q=_(K,[["__scopeId","data-v-0302669a"]]),R={class:"mapnav absolute right-0 bottom-0 pb-36 sm:pb-48 pr-12"},ee=["content"],te={class:"mapnav-section bg-white-75 hover:bg-white"},oe=$({__name:"mapnav",setup(g){const a=z("iApi"),t=x(),{t:e}=k(),o=P(),s=C(()=>a.getConfig().fixtures.mapnav.items.some(i=>i==="draw")),r=()=>{o.value._tippy.hide()},l=i=>{i.key==="Tab"&&o.value?.matches(":focus")&&o.value._tippy.show()};Y(()=>{o.value?.addEventListener("blur",r),o.value?.addEventListener("keyup",l)}),j(()=>{o.value?.removeEventListener("blur",r),o.value?.removeEventListener("keyup",l)});const p=C(()=>t.order.map(i=>t.items[i]).filter(i=>i.componentId&&i.id!=="draw"));return(i,u)=>{const d=N("focus-list"),H=N("tippy");return n(),c("div",R,[B((n(),c("div",{class:"flex flex-col",content:v(e)("panels.controls.items"),ref_key:"el",ref:o},[s.value?(n(),c(w,{key:0},[y(Q),u[0]||(u[0]=m("span",{class:"py-1"},null,-1))],64)):S("",!0),y(J,{class:"mapnav-section bg-white-75 hover:bg-white"}),u[1]||(u[1]=m("span",{class:"py-1"},null,-1)),m("div",te,[(n(!0),c(w,null,O(p.value,(I,V)=>(n(),c(w,{key:I.id+"button"},[(n(),b(F(I.id+"-nav-button"))),V!==p.value.length-1?(n(),b(L,{key:0,class:"mapnav-divider"})):S("",!0)],64))),128))])],8,ee)),[[d],[H,{trigger:"manual",placement:"top-end",touch:!1,maxWidth:190}]])])}}}),ae=_(oe,[["__scopeId","data-v-96b1b7dc"]]);class ne extends G{mapnavStore=x(this.$vApp.$pinia);get config(){return super.config}_parseConfig(a){if(!a)return;const t=a.items.map(e=>({id:e}));this.mapnavStore.items=t.reduce((e,o)=>(e[o.id]=o,e),{}),this.mapnavStore.order=t.map(e=>e.id),this._validateItems()}_validateItems(){const a=["geolocator","zoom","home","fullscreen"];this.mapnavStore.order.forEach(t=>{(this.$iApi.fixture.exists(t)||a.includes(t))&&(this.mapnavStore.items[t].componentId=`${t}-nav-button`)})}}const se={en:{"mapnav.zoomIn":"Zoom In","mapnav.zoomOut":"Zoom Out","mapnav.home":"Home","mapnav.fullscreen":"Full Screen","mapnav.geolocator":"Your Location","mapnav.geolocator.error.permission":"The location request was denied. Please check your browser permission settings.","mapnav.geolocator.error.internal":"Your location could not be found."},fr:{"mapnav.zoomIn":"Zoom avant","mapnav.zoomOut":"Zoom arri\xE8re","mapnav.home":"Accueil","mapnav.fullscreen":"Plein \xC9cran","mapnav.geolocator":"Votre position","mapnav.geolocator.error.permission":"Demande de localisation refus\xE9e. Veuillez v\xE9rifier les param\xE8tres d'autorisation de votre navigateur.","mapnav.geolocator.error.internal":"Votre emplacement n'a pu \xEAtre trouv\xE9."}};class ie extends ne{async added(){Object.entries(se).forEach(s=>this.$iApi.$i18n.mergeLocaleMessage(...s));const{destroy:a,el:t}=this.mount(ae,{app:this.$element});this.$vApp.$el.getElementsByClassName("inner-shell")[0].appendChild(t.childNodes[0]),this._parseConfig(this.config);const e=this.$vApp.$watch(()=>this.config,s=>this._parseConfig(s)),o=this.$iApi.event.on(W.COMPONENT,()=>{this._parseConfig(this.config)});this.removed=()=>{e(),this.$iApi.event.off(o);const s=x(this.$vApp.$pinia),r={...s.items};Object.keys(r).forEach(l=>s.removeItem(l)),s.$reset(),a()}}}export{ie as default};
