const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./point-icon-d0yPsl3W.js","./main-Ca-A5Z1g.js","./preload-helper-B76NpbEU.js","./main-dpdk7fuu.css","./polyline-icon-ZknjtULW.js","./polygon-icon-D_5sU9Ns.js","./circle-icon-B6F5li2o.js","./rectangle-icon-s4VJrZxX.js","./edit-icon-B58f4Mns.js"])))=>i.map(i=>d[i]);
import{dr as F,ds as r,dt as e,eM as L,eN as S,f4 as V,jR as R,eT as D,fb as b,eU as d,eV as I,du as u,gl as _,fc as f,eQ as O,eX as A,eW as M,eS as y,jI as T,hv as W,eZ as Y,aa as $,gn as P,f3 as G,jS as X,f5 as J,eR as B,f6 as g,eY as j,F as K,f9 as ee}from"./main-Ca-A5Z1g.js";import{_ as w}from"./preload-helper-B76NpbEU.js";import{u as te}from"./draw-store-DETSieP_.js";const oe={},ne={class:"border-b p-0 self-center w-2/3"};function ae(x,a){return e(),r("span",ne)}const Q=F(oe,[["render",ae]]),se=L({__name:"zoom-nav",setup(x){const{t:a}=S(),t=V("iApi"),o=R(400,!0,()=>t.geo.map.zoomIn()),c=R(400,!0,()=>t.geo.map.zoomOut());return(s,n)=>{const l=D("mapnav-button");return e(),r("div",null,[b(l,{onClickFunction:d(o),tooltip:d(a)("mapnav.zoomIn")},{default:I(()=>n[0]||(n[0]=[u("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",class:"fill-current w-32 h-20"},[u("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),u("path",{d:"M0 0h24v24H0z",fill:"none"})],-1)])),_:1},8,["onClickFunction","tooltip"]),b(Q),b(l,{onClickFunction:d(c),tooltip:d(a)("mapnav.zoomOut")},{default:I(()=>n[1]||(n[1]=[u("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",class:"fill-current w-32 h-20"},[u("path",{d:"M19 13H5v-2h14v2z"}),u("path",{d:"M0 0h24v24H0z",fill:"none"})],-1)])),_:1},8,["onClickFunction","tooltip"])])}}}),ie={class:"mapnav-section bg-white-75 hover:bg-white"},re=L({__name:"draw-nav-section",setup(x){const a=V("iApi"),{t}=S(),o=te(),c=[{type:"point",icon:_(f(()=>w(()=>import("./point-icon-d0yPsl3W.js"),__vite__mapDeps([0,1,2,3]),import.meta.url)))},{type:"polyline",icon:_(f(()=>w(()=>import("./polyline-icon-ZknjtULW.js"),__vite__mapDeps([4,1,2,3]),import.meta.url)))},{type:"polygon",icon:_(f(()=>w(()=>import("./polygon-icon-D_5sU9Ns.js"),__vite__mapDeps([5,1,2,3]),import.meta.url)))},{type:"circle",icon:_(f(()=>w(()=>import("./circle-icon-B6F5li2o.js"),__vite__mapDeps([6,1,2,3]),import.meta.url)))},{type:"rectangle",icon:_(f(()=>w(()=>import("./rectangle-icon-s4VJrZxX.js"),__vite__mapDeps([7,1,2,3]),import.meta.url)))}],s=O(()=>{const i=c.filter(v=>o.supportedTypes.some(k=>k.type===v.type));return i.push({type:"edit",icon:_(f(()=>w(()=>import("./edit-icon-B58f4Mns.js"),__vite__mapDeps([8,1,2,3]),import.meta.url)))}),i}),n=i=>{o.activeTool===i?o.setActiveTool(null):o.setActiveTool(i)},l=()=>{a.geo.map.setMouseFocus()};return(i,v)=>{const k=D("mapnav-button");return e(),r("div",ie,[(e(!0),r(A,null,M(s.value,(m,z)=>(e(),y(k,{key:m.type,onMousedown:l,onClickFunction:()=>n(m.type),tooltip:d(t)(`draw.${m.type}.tooltip`),class:Y({"active-tool":d(o).activeTool===m.type}),style:W({marginBottom:z!==s.value.length-1?"0px":"0"})},{default:I(()=>[(e(),y(T(m.icon),{class:"fill-current w-32 h-20"}))]),_:2},1032,["onClickFunction","tooltip","class","style"]))),128))])}}}),Z=F(re,[["__scopeId","data-v-f8a13970"]]),le={class:"mapnav absolute right-0 bottom-0 pb-36 sm:pb-48 pr-12"},ce=["content"],pe={class:"mapnav-section bg-white-75 hover:bg-white"},ue={key:1,class:"mapnav-section bg-white-75 hover:bg-white"},ve=["content"],me={key:0},de=L({__name:"mapnav",setup(x){const a=$(void 0),t=V("iApi"),o=P(),{t:c}=S(),s=$(),n=O(()=>t.getConfig().fixtures.mapnav.items.some(p=>p==="draw")),l=$(t.$rootEl?.clientHeight),i=$(!1),v=$(0),k=()=>{l.value=t.$rootEl?.clientHeight},m=()=>{s.value._tippy.hide()},z=p=>{p.key==="Tab"&&s.value?.matches(":focus")&&s.value._tippy.show()};G(()=>{s.value?.addEventListener("blur",m),s.value?.addEventListener("keyup",z),a.value=new ResizeObserver(k),a.value.observe(t.$rootEl),X(()=>{v.value=C.value.length*82})}),J(()=>{s.value?.removeEventListener("blur",m),s.value?.removeEventListener("keyup",z),a.value.disconnect()});const C=O(()=>o.order.map(p=>o.items[p]).filter(p=>p.componentId&&p.id!=="draw"));return(p,h)=>{const U=D("mapnav-button"),q=j("focus-list"),H=j("tippy");return e(),r("div",le,[B((e(),r("div",{class:"mapnav-section flex flex-col",content:d(c)("panels.controls.items"),ref_key:"el",ref:s},[n.value&&l.value>v.value?(e(),r(A,{key:0},[b(Z),h[0]||(h[0]=u("span",{class:"py-1"},null,-1))],64)):g("",!0),b(se,{class:"mapnav-section bg-white-75 hover:bg-white"}),h[2]||(h[2]=u("span",{class:"py-1"},null,-1)),u("div",pe,[l.value<=v.value?(e(),y(U,{key:0,class:"self-center",onClickFunction:()=>{i.value=!i.value},tooltip:i.value?p.$t("mapnav.closeMenu"):p.$t("mapnav.openMenu")},{default:I(()=>[(e(),r("svg",{xmlns:"http://www.w3.org/2000/svg","shape-rendering":"geometricPrecision","text-rendering":"geometricPrecision","image-rendering":"optimizeQuality","fill-rule":"evenodd","clip-rule":"evenodd",viewBox:"0 0 319 511.61",class:Y(["fill-current w-6 mx-auto transition-all transform",{"rotate-180":i.value}])},h[1]||(h[1]=[u("path",{d:"m270.08 5.89 43.04 43.04c7.85 7.86 7.83 20.72 0 28.54L134.77 255.82l178.35 178.35c7.85 7.86 7.8 20.73 0 28.54l-43.04 43.04c-7.83 7.82-20.71 7.82-28.54 0L49.29 313.49l-.37-.36-43.04-43.04c-7.82-7.83-7.86-20.68 0-28.54l43.04-43.04.37-.36L241.54 5.89c7.85-7.85 20.68-7.85 28.54 0z"},null,-1)]),2))]),_:1},8,["onClickFunction","tooltip"])):g("",!0)]),l.value>v.value?(e(),r("div",ue,[(e(!0),r(A,null,M(C.value,(E,N)=>(e(),r(A,{key:E.id+"button"},[(e(),y(T(E.id+"-nav-button"))),N!==C.value.length-1?(e(),y(Q,{key:0,class:"mapnav-divider"})):g("",!0)],64))),128))])):g("",!0)],8,ce)),[[q],[H,{trigger:"manual",placement:"top-end",touch:!1,maxWidth:190}]]),l.value<=v.value&&i.value?B((e(),r("div",{key:0,class:"mapnav-section flex flex-col flex-wrap-reverse shadow-tm absolute right-56 bottom-36 sm:bottom-48 items-start z-50 gap-0.5",style:W({maxHeight:`${(l.value-70)*.8}px`,height:"fit-content",width:"fit-content"}),content:d(c)("panels.controls.items")},[n.value?(e(),r("div",me,[b(Z)])):g("",!0),(e(!0),r(A,null,M(C.value,(E,N)=>(e(),y(T(E.id+"-nav-button"),{key:E.id+"button",class:"mapnav-section bg-white-75 hover:bg-white",showOutline:""}))),128))],12,ve)),[[H,{trigger:"manual",placement:"top-end",maxWidth:190}]]):g("",!0)])}}}),he=F(de,[["__scopeId","data-v-8bd78dc3"]]);class _e extends K{mapnavStore=P(this.$vApp.$pinia);get config(){return super.config}_parseConfig(a){if(!a)return;const t=a.items.map(o=>({id:o}));this.mapnavStore.items=t.reduce((o,c)=>(o[c.id]=c,o),{}),this.mapnavStore.order=t.map(o=>o.id),this._validateItems()}_validateItems(){const a=["geolocator","zoom","home","fullscreen"];this.mapnavStore.order.forEach(t=>{(this.$iApi.fixture.exists(t)||a.includes(t))&&(this.mapnavStore.items[t].componentId=`${t}-nav-button`)})}}const fe={en:{"mapnav.openMenu":"Open navigation","mapnav.closeMenu":"Close navigation","mapnav.zoomIn":"Zoom In","mapnav.zoomOut":"Zoom Out","mapnav.home":"Home","mapnav.fullscreen":"Full Screen","mapnav.geolocator":"Your Location","mapnav.geolocator.error.permission":"The location request was denied. Please check your browser permission settings.","mapnav.geolocator.error.internal":"Your location could not be found."},fr:{"mapnav.openMenu":"Ouvrir la navigation","mapnav.closeMenu":"Fermer la navigation","mapnav.zoomIn":"Zoom avant","mapnav.zoomOut":"Zoom arrière","mapnav.home":"Accueil","mapnav.fullscreen":"Plein Écran","mapnav.geolocator":"Votre position","mapnav.geolocator.error.permission":"Demande de localisation refusée. Veuillez vérifier les paramètres d'autorisation de votre navigateur.","mapnav.geolocator.error.internal":"Votre emplacement n'a pu être trouvé."}};class be extends _e{async added(){Object.entries(fe).forEach(n=>this.$iApi.$i18n.mergeLocaleMessage(...n));const{destroy:a,el:t}=this.mount(he,{app:this.$element});this.$vApp.$el.getElementsByClassName("inner-shell")[0].appendChild(t.childNodes[0]),this._parseConfig(this.config);const c=this.$vApp.$watch(()=>this.config,n=>this._parseConfig(n)),s=this.$iApi.event.on(ee.COMPONENT,()=>{this._parseConfig(this.config)});this.removed=()=>{c(),this.$iApi.event.off(s);const n=P(this.$vApp.$pinia),l={...n.items};Object.keys(l).forEach(i=>n.removeItem(i)),n.$reset(),a()}}}export{be as default};
