import{a1 as E,a2 as k,dO as w,hp as A,dP as L,dS as $,e2 as H,e5 as C,e7 as N,d2 as y,d$ as u,g5 as T,d3 as n,d_ as p,e9 as x,e0 as z,dY as S,d4 as h,F as D}from"./main-CUH7s9Sn.js";import"./preload-helper-ExcqyqRp.js";const F={en:{"keyboardnav.activeNamespace":"Namespace Active: {name}","keyboardnav.helpTitle":"Keyboard Shortcuts","keyboardnav.keysTitle":"Keys for {name}","keyboardnav.helpDescription":"To use keyboard shortcuts refer to the global list below or start by activating a feature group using the combo <span class='key indigo'>SHIFT + [letter]</span>. Once a group is active, its specific shortcuts will appear beneath it. Use <span class='key zinc'>[key]</span> to trigger individual actions within that group.","keyboardnav.noShortcuts":"No shortcuts available.","keyboardnav.mainShortcuts.title":"Global controls","keyboardnav.mainShortcuts.numbers":"Focus on an open panel (1 being leftmost)","keyboardnav.mainShortcuts.escape":"Close a focused panel"},fr:{"keyboardnav.activeNamespace":"Espace de noms actif : {name}","keyboardnav.helpTitle":"Raccourcis clavier","keyboardnav.keysTitle":"Raccourcis pour {name}","keyboardnav.helpDescription":"Pour utiliser les raccourcis clavier, consultez la liste globale ci-dessous ou commencez par activer un groupe de fonctionnalités avec la combinaison <span class='key indigo'>SHIFT + [lettre]</span>. Une fois le groupe actif, ses raccourcis spécifiques apparaîtront en dessous. Utilisez <span class='key zinc'>[touche]</span> pour déclencher les actions individuelles de ce groupe.","keyboardnav.noShortcuts":"Aucun raccourci disponible.","keyboardnav.mainShortcuts.title":"Contrôles globaux","keyboardnav.mainShortcuts.numbers":"Concentrer sur un panneau ouvert (1 étant le plus à gauche)","keyboardnav.mainShortcuts.escape":"Fermer un panneau en focus"}},_=E("keyboardnav",()=>{const c=k(null),e=k({}),a=k(!1),d=["H","?"];function i(){const s="ABCDEFGHIJKLMNOPQRSTUVWXYZ";for(const t of s)if(!e.value[t]&&!d.includes(t))return t;return null}function o(s,t){let r=s.toUpperCase();if(d.includes(r)||e.value[r]){const l=i();l?r=l:console.error("No available keyboard namespace letters")}if(!t.handler)for(const l of t.keys)l.handler||console.error(`Keyboardnav registration for ${r} requires handlers for all keys or a parent handler`);return e.value[r]=t,r}function v(s){a.value!==s&&(a.value=s)}function f(s){c.value===s&&(c.value=null),delete e.value[s]}function b(s,t){c.value=s,e.value[s]?.activeHandler?.(t)}function m(s){c.value&&e.value[c.value]?.deactiveHandler?.(s),c.value=null}function g(s,t){const r=c.value;if(!r)return;const l=e.value[r];l&&(l.handler?l.handler(s,t):l.keys.find(K=>K.key===s)?.handler?.(t))}return{activeNamespace:c,namespaces:e,helpVisible:a,register:o,unregister:f,activate:b,deactivate:m,trigger:g,setHelpVisible:v}}),I={class:"relative w-[640px] max-h-[80vh] overflow-y-auto rounded-xl bg-white py-8 px-10 shadow-xl",role:"dialog","aria-modal":"true","aria-live":"polite"},U={class:"border-b border-gray-200 bg-white px-4 py-20 sm:px-24"},V={class:"text-base font-semibold text-gray-900"},R=["innerHTML"],B={role:"list",class:"m-0 max-w-[calc(var(--container-lg)-(--spacing(8)))] list-none divide-y divide-zinc-900/5 p-0 dark:divide-white/5"},M={class:"pl-24 mb-8 py-16"},O={class:"flex items-center gap-x-12"},j={class:"font-mono text-md text-zinc-600"},P={class:"space-y-4 p-16 pl-24"},q={class:"flex items-center gap-x-12"},G={class:"font-mono text-md text-zinc-600"},Y={class:"flex items-center gap-x-12"},J={class:"font-mono text-md text-zinc-600"},Q={key:0,class:"pl-24 mb-8 py-16 border-b"},W={class:"font-mono text-md text-zinc-600"},X={class:"flex items-center gap-x-12"},Z={class:"font-mono px-6 text-[0.825rem]/6 font-semibold rounded-lg px-1.5 ring-1 ring-inset ring-indigo-300 bg-indigo-400/10 text-indigo-500 dark:ring-indigo-400/30 dark:bg-indigo-400/10 dark:text-indigo-400"},ee={class:"font-mono text-md text-zinc-600"},te={key:0,class:"space-y-4 p-16 pl-24"},ne={class:"font-mono px-6 text-[0.825rem]/6 font-semibold rounded-lg px-1.5 ring-1 ring-inset ring-zinc-300 bg-zinc-400/10 text-zinc-500 dark:ring-zinc-400/30 dark:bg-zinc-400/10 dark:text-zinc-400"},se={class:"font-mono text-md text-zinc-600"},ae=w({__name:"keyboardnav",setup(c){const e=_(),{activeNamespace:a,namespaces:d,helpVisible:i}=A(e),{t:o}=L(),v=$(()=>Object.keys(d.value)),f=$(()=>{const s=a.value;return s?d.value[s]?.keys||[]:[]}),b=H("overlayRef");function m(){e.setHelpVisible(!1)}function g(s){const t=s.target;b.value&&t&&!b.value.contains(t)&&m()}return C(i,s=>{s?document.addEventListener("focusin",g):document.removeEventListener("focusin",g)}),N(()=>{document.removeEventListener("focusin",g)}),(s,t)=>(h(),y("div",null,[u(i)?(h(),y("div",{key:0,ref_key:"overlayRef",ref:b,onClick:T(m,["self"]),class:"absolute inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 transition-opacity",tabindex:"-1"},[n("div",I,[n("button",{class:"absolute right-8 top-8 rounded px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:m},p(u(o)("panels.controls.close")),1),n("div",U,[n("h3",V,p(u(o)("keyboardnav.helpTitle")),1),n("div",{innerHTML:u(o)("keyboardnav.helpDescription"),class:"mt-6 text-sm text-gray-500"},null,8,R)]),n("ul",B,[n("li",M,[n("div",O,[n("span",j,p(u(o)("keyboardnav.mainShortcuts.title")),1)]),n("div",P,[n("div",q,[t[0]||(t[0]=n("span",{class:"font-mono px-6 text-[0.825rem]/6 font-semibold rounded-lg px-1.5 ring-1 ring-inset ring-zinc-300 bg-zinc-400/10 text-zinc-500 dark:ring-zinc-400/30 dark:bg-zinc-400/10 dark:text-zinc-400"}," 1-5 ",-1)),t[1]||(t[1]=n("span",{class:"h-2 w-2 rounded-full bg-zinc-300 dark:bg-zinc-600"},null,-1)),n("span",G,p(u(o)("keyboardnav.mainShortcuts.numbers")),1)]),n("div",Y,[t[2]||(t[2]=n("span",{class:"font-mono px-6 text-[0.825rem]/6 font-semibold rounded-lg px-1.5 ring-1 ring-inset ring-zinc-300 bg-zinc-400/10 text-zinc-500 dark:ring-zinc-400/30 dark:bg-zinc-400/10 dark:text-zinc-400"}," ESC ",-1)),t[3]||(t[3]=n("span",{class:"h-2 w-2 rounded-full bg-zinc-300 dark:bg-zinc-600"},null,-1)),n("span",J,p(u(o)("keyboardnav.mainShortcuts.escape")),1)])])]),v.value.length===0?(h(),y("li",Q,[n("p",W,p(u(o)("keyboardnav.noShortcuts")),1)])):x("",!0),(h(!0),y(z,null,S(v.value,r=>(h(),y("li",{key:r,class:"pl-24 mb-8 py-16 border-b"},[n("div",X,[n("span",Z," SHIFT + "+p(r),1),t[4]||(t[4]=n("span",{class:"h-2 w-2 rounded-full bg-zinc-300 dark:bg-zinc-600"},null,-1)),n("span",ee,p(u(o)(`keyboardnav.ns.${r}`)),1)]),u(a)===r?(h(),y("div",te,[(h(!0),y(z,null,S(f.value,l=>(h(),y("div",{key:l.key,class:"flex items-center gap-x-12"},[n("span",ne,p(l.key),1),t[5]||(t[5]=n("span",{class:"h-2 w-2 rounded-full bg-zinc-300 dark:bg-zinc-600"},null,-1)),n("span",se,p(u(o)(`keyboardnav.key.${r}.${l.key}`)),1)]))),128))])):x("",!0)]))),128))])])],512)):x("",!0)]))}});class ie extends D{keyboardnavStore=_(this.$vApp.$pinia);_isInput(e){return!e||!(e instanceof HTMLElement)?!1:!!e.closest('input, textarea, [contenteditable="true"]')}register(e,a){const d=e.toUpperCase(),i=this.keyboardnavStore.register(d,a),o=`keyboardnav.ns.${i}`;return Object.entries(a.name).forEach(([v,f])=>{this.$iApi.$i18n.mergeLocaleMessage(v,{[o]:f})}),a.keys.forEach(v=>{const f=`keyboardnav.key.${i}.${v.key}`;Object.entries(v.description).forEach(([b,m])=>{this.$iApi.$i18n.mergeLocaleMessage(b,{[f]:m})})}),i}added(){this.$iApi.$rootEl?.addEventListener("keydown",e=>this._handleKeyDown(e)),this.$iApi.$rootEl?.addEventListener("keyup",e=>this._handleKeyUp(e)),this.$iApi.$rootEl?.addEventListener("blur",this._handleBlur)}removed(){this.$iApi.$rootEl?.removeEventListener("keydown",e=>this._handleKeyDown(e)),this.$iApi.$rootEl?.removeEventListener("keyup",e=>this._handleKeyUp(e)),this.$iApi.$rootEl?.removeEventListener("blur",this._handleBlur)}_handleKeyDown=e=>{if(this._isInput(e.target))return;if(!e.shiftKey&&!e.altKey&&!e.ctrlKey&&!e.metaKey){if(/^[1-5]$/.test(e.key)){const d=parseInt(e.key)-1,i=this.$iApi.panel.visible[d];i&&(e.preventDefault(),this.$iApi.panel.focus(i));return}else if(e.key==="Escape"){const i=e.target.closest("[data-cy]");if(i&&this.$iApi.$rootEl?.querySelector(".panel-container")?.contains(i)){e.preventDefault();const o=i.getAttribute("data-cy");o&&this.$iApi.panel.close(o)}return}}const a=e.key.toUpperCase();e.shiftKey&&!e.altKey&&!e.ctrlKey&&!e.metaKey?a in this.keyboardnavStore.namespaces&&(e.preventDefault(),this.keyboardnavStore.activeNamespace===a?this.keyboardnavStore.deactivate(e):this.keyboardnavStore.activate(a,e)):!e.shiftKey&&!e.altKey&&!e.ctrlKey&&!e.metaKey&&a.length===1&&this.keyboardnavStore.activeNamespace&&(e.preventDefault(),this.keyboardnavStore.trigger(a,e))};_handleKeyUp=e=>{this._isInput(e.target)||(e.key.toUpperCase()==="H"||e.key==="?")&&e.shiftKey&&!e.altKey&&!e.ctrlKey&&!e.metaKey&&(e.preventDefault(),this.keyboardnavStore.setHelpVisible(!this.keyboardnavStore.helpVisible))};_handleBlur=e=>{this.keyboardnavStore.deactivate(e),this.keyboardnavStore.setHelpVisible(!1)}}class ce extends ie{added(){Object.entries(F).forEach(i=>this.$iApi.$i18n.mergeLocaleMessage(...i));const{destroy:e,el:a}=this.mount(ae,{app:this.$element});this.$vApp.$el.getElementsByClassName("inner-shell")[0].appendChild(a.childNodes[0]),super.added(),this.removed=()=>{super.removed(),e(),_(this.$vApp.$pinia).$reset()}}}export{ce as default};
