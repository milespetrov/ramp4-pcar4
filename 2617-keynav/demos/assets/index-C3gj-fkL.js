const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./point-icon-Cl77g8D3.js","./main-CUH7s9Sn.js","./preload-helper-ExcqyqRp.js","./main-DtpOknRx.css","./polyline-icon-DKH03SQo.js","./polygon-icon-CyzjjNDq.js","./circle-icon-DpKi4ZEU.js","./rectangle-icon-D7ZICx70.js","./edit-icon-CoTV4Kir.js"])))=>i.map(i=>d[i]);
import{d1 as I,d4 as s,d2 as m,dO as k,dP as x,e1 as $,iK as z,dT as V,ed as w,dX as E,d3 as l,d$ as u,e2 as B,fi as _,ee as h,dS as A,e0 as y,dY as F,dW as b,iI as L,dZ as O,fk as C,a2 as R,e6 as H,e7 as Z,dU as D,dV as j,e9 as S,F as Y,eb as U}from"./main-CUH7s9Sn.js";import{_ as f}from"./preload-helper-ExcqyqRp.js";import{u as W}from"./draw-store-41KY22iZ.js";const q={},G={class:"border-b p-0 self-center w-2/3"};function K(g,a){return s(),m("span",G)}const M=I(q,[["render",K]]),X=k({__name:"zoom-nav",setup(g){const{t:a}=x(),t=$("iApi"),e=z(400,!0,()=>t.geo.map.zoomIn()),o=z(400,!0,()=>t.geo.map.zoomOut());return(d,n)=>{const c=V("mapnav-button");return s(),m("div",null,[w(c,{onClickFunction:u(e),tooltip:u(a)("mapnav.zoomIn")},{default:E(()=>n[0]||(n[0]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",class:"fill-current w-32 h-20"},[l("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),l("path",{d:"M0 0h24v24H0z",fill:"none"})],-1)])),_:1},8,["onClickFunction","tooltip"]),w(M),w(c,{onClickFunction:u(o),tooltip:u(a)("mapnav.zoomOut")},{default:E(()=>n[1]||(n[1]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",class:"fill-current w-32 h-20"},[l("path",{d:"M19 13H5v-2h14v2z"}),l("path",{d:"M0 0h24v24H0z",fill:"none"})],-1)])),_:1},8,["onClickFunction","tooltip"])])}}}),J=k({__name:"draw-nav-section",setup(g){const a=$("iApi"),{t}=x(),e=W();e.mapNavEl=B("mapNavEl");const o=[{type:"point",icon:_(h(()=>f(()=>import("./point-icon-Cl77g8D3.js"),__vite__mapDeps([0,1,2,3]),import.meta.url)))},{type:"polyline",icon:_(h(()=>f(()=>import("./polyline-icon-DKH03SQo.js"),__vite__mapDeps([4,1,2,3]),import.meta.url)))},{type:"polygon",icon:_(h(()=>f(()=>import("./polygon-icon-CyzjjNDq.js"),__vite__mapDeps([5,1,2,3]),import.meta.url)))},{type:"circle",icon:_(h(()=>f(()=>import("./circle-icon-DpKi4ZEU.js"),__vite__mapDeps([6,1,2,3]),import.meta.url)))},{type:"rectangle",icon:_(h(()=>f(()=>import("./rectangle-icon-D7ZICx70.js"),__vite__mapDeps([7,1,2,3]),import.meta.url)))}],d=A(()=>{const r=o.filter(i=>e.supportedTypes.some(p=>p.type===i.type));return r.push({type:"edit",icon:_(h(()=>f(()=>import("./edit-icon-CoTV4Kir.js"),__vite__mapDeps([8,1,2,3]),import.meta.url)))}),r}),n=r=>{e.activeTool===r?e.setActiveTool(null):e.setActiveTool(r)},c=()=>{a.geo.map.setMouseFocus()};return(r,i)=>{const p=V("mapnav-button");return s(),m("div",{class:O([{active:u(e).activeTool||u(e).activeTool==""},"mapnav-section bg-white-75 hover:bg-white"])},[(s(!0),m(y,null,F(d.value,v=>(s(),b(p,{key:v.type,onMousedown:c,onClickFunction:()=>n(v.type),tooltip:u(t)(`draw.${v.type}.tooltip`),class:O({"active-tool":u(e).activeTool===v.type}),ref_for:!0,ref:"mapNavEl"},{default:E(()=>[(s(),b(L(v.icon),{class:"fill-current w-32 h-20"}))]),_:2},1032,["onClickFunction","tooltip","class"]))),128))],2)}}}),Q=I(J,[["__scopeId","data-v-55183d45"]]),ee={class:"mapnav absolute right-0 bottom-0 pb-36 sm:pb-48 pr-12"},te=["content"],oe={class:"mapnav-section bg-white-75 hover:bg-white"},ne=k({__name:"mapnav",setup(g){const a=$("iApi"),t=C(),{t:e}=x(),o=R(),d=A(()=>a.getConfig().fixtures.mapnav.items.some(i=>i==="draw")),n=()=>{o.value._tippy.hide()},c=i=>{i.key==="Tab"&&o.value?.matches(":focus")&&o.value._tippy.show()};H(()=>{o.value?.addEventListener("blur",n),o.value?.addEventListener("keyup",c)}),Z(()=>{o.value?.removeEventListener("blur",n),o.value?.removeEventListener("keyup",c)});const r=A(()=>t.order.map(i=>t.items[i]).filter(i=>i.componentId&&i.id!=="draw"));return(i,p)=>{const v=D("focus-list"),N=D("tippy");return s(),m("div",ee,[j((s(),m("div",{class:"flex flex-col",content:u(e)("panels.controls.items"),ref_key:"el",ref:o},[d.value?(s(),m(y,{key:0},[w(Q),p[0]||(p[0]=l("span",{class:"py-1"},null,-1))],64)):S("",!0),w(X,{class:"mapnav-section bg-white-75 hover:bg-white"}),p[1]||(p[1]=l("span",{class:"py-1"},null,-1)),l("div",oe,[(s(!0),m(y,null,F(r.value,(T,P)=>(s(),m(y,{key:T.id+"button"},[(s(),b(L(T.id+"-nav-button"))),P!==r.value.length-1?(s(),b(M,{key:0,class:"mapnav-divider"})):S("",!0)],64))),128))])],8,te)),[[v],[N,{trigger:"manual",placement:"top-end",touch:!1,maxWidth:190}]])])}}}),ae=I(ne,[["__scopeId","data-v-acc79bff"]]);class se extends Y{mapnavStore=C(this.$vApp.$pinia);get config(){return super.config}_parseConfig(a){if(!a)return;const t=a.items.map(e=>({id:e}));this.mapnavStore.items=t.reduce((e,o)=>(e[o.id]=o,e),{}),this.mapnavStore.order=t.map(e=>e.id),this._validateItems()}_validateItems(){const a=["geolocator","zoom","home","fullscreen"];this.mapnavStore.order.forEach(t=>{(this.$iApi.fixture.exists(t)||a.includes(t))&&(this.mapnavStore.items[t].componentId=`${t}-nav-button`)})}}const ie={en:{"mapnav.zoomIn":"Zoom In","mapnav.zoomOut":"Zoom Out","mapnav.home":"Home","mapnav.fullscreen":"Full Screen","mapnav.geolocator":"Your Location","mapnav.geolocator.error.permission":"The location request was denied. Please check your browser permission settings.","mapnav.geolocator.error.internal":"Your location could not be found."},fr:{"mapnav.zoomIn":"Zoom avant","mapnav.zoomOut":"Zoom arrière","mapnav.home":"Accueil","mapnav.fullscreen":"Plein Écran","mapnav.geolocator":"Votre position","mapnav.geolocator.error.permission":"Demande de localisation refusée. Veuillez vérifier les paramètres d'autorisation de votre navigateur.","mapnav.geolocator.error.internal":"Votre emplacement n'a pu être trouvé."}};class le extends se{async added(){Object.entries(ie).forEach(n=>this.$iApi.$i18n.mergeLocaleMessage(...n));const{destroy:a,el:t}=this.mount(ae,{app:this.$element});this.$vApp.$el.getElementsByClassName("inner-shell")[0].appendChild(t.childNodes[0]),this._parseConfig(this.config);const o=this.$vApp.$watch(()=>this.config,n=>this._parseConfig(n)),d=this.$iApi.event.on(U.COMPONENT,()=>{this._parseConfig(this.config)});this.removed=()=>{o(),this.$iApi.event.off(d);const n=C(this.$vApp.$pinia),c={...n.items};Object.keys(c).forEach(r=>n.removeItem(r)),n.$reset(),a()}}}export{le as default};
