{"version":3,"file":"index-B2p9rgc2.js","sources":["../../src/fixtures/keyboardnav/lang/lang.csv?raw","../../src/fixtures/keyboardnav/keyboardnav.vue","../../src/fixtures/keyboardnav/api/keyboardnav.ts","../../src/fixtures/keyboardnav/index.ts"],"sourcesContent":["export default \"key,enValue,enValid,frValue,frValid\\nkeyboardnav.activeNamespace,Namespace Active: {name},1,Espace de noms actif : {name},0\\nkeyboardnav.helpTitle,Keyboard Shortcuts,1,Raccourcis clavier,0\\nkeyboardnav.keysTitle,Keys for {name},1,Raccourcis pour {name},0\\nkeyboardnav.helpDescription,Press <span class=\\\"font-mono px-6 text-[0.825rem]/6 font-semibold rounded-lg px-1.5 ring-1 ring-inset ring-zinc-300 bg-zinc-400/10 text-zinc-500 dark:ring-zinc-400/30 dark:bg-zinc-400/10 dark:text-zinc-400\\\">S</span> to start fixture shortcuts then type the fixture key (for example <span class=\\\"font-mono px-6 text-[0.825rem]/6 font-semibold rounded-lg px-1.5 ring-1 ring-inset ring-zinc-300 bg-zinc-400/10 text-zinc-500 dark:ring-zinc-400/30 dark:bg-zinc-400/10 dark:text-zinc-400\\\">D</span>) followed by an action key like <span class=\\\"font-mono px-6 text-[0.825rem]/6 font-semibold rounded-lg px-1.5 ring-1 ring-inset ring-zinc-300 bg-zinc-400/10 text-zinc-500 dark:ring-zinc-400/30 dark:bg-zinc-400/10 dark:text-zinc-400\\\">L</span>. Use <span class=\\\"font-mono px-6 text-[0.825rem]/6 font-semibold rounded-lg px-1.5 ring-1 ring-inset ring-zinc-300 bg-zinc-400/10 text-zinc-500 dark:ring-zinc-400/30 dark:bg-zinc-400/10 dark:text-zinc-400\\\">Escape</span> to clear the chain or <span class=\\\"font-mono px-6 text-[0.825rem]/6 font-semibold rounded-lg px-1.5 ring-1 ring-inset ring-zinc-300 bg-zinc-400/10 text-zinc-500 dark:ring-zinc-400/30 dark:bg-zinc-400/10 dark:text-zinc-400\\\">Backspace</span> to undo the last key.,1,Appuyez sur <span class='key indigo'>S</span> pour dAcmarrer les raccourcis de module puis saisissez la touche du module (par exemple <span class='key indigo'>D</span>) suivie d'une touche d'action comme <span class=\\\"font-mono px-6 text-[0.825rem]/6 font-semibold rounded-lg px-1.5 ring-1 ring-inset ring-zinc-300 bg-zinc-400/10 text-zinc-500 dark:ring-zinc-400/30 dark:bg-zinc-400/10 dark:text-zinc-400\\\">L</span>. Utilisez <span class=\\\"font-mono px-6 text-[0.825rem]/6 font-semibold rounded-lg px-1.5 ring-1 ring-inset ring-zinc-300 bg-zinc-400/10 text-zinc-500 dark:ring-zinc-400/30 dark:bg-zinc-400/10 dark:text-zinc-400\\\">Echap</span> pour effacer la chaAne ou <span class=\\\"font-mono px-6 text-[0.825rem]/6 font-semibold rounded-lg px-1.5 ring-1 ring-inset ring-zinc-300 bg-zinc-400/10 text-zinc-500 dark:ring-zinc-400/30 dark:bg-zinc-400/10 dark:text-zinc-400\\\">Retour</span> pour enlever la derniA\\\\\\\"re touche.,0\\nkeyboardnav.noShortcuts,No shortcuts available.,1,Aucun raccourci disponible.,0\\nkeyboardnav.mainShortcuts.title,Global controls,1,ContrA'les globaux,0\\nkeyboardnav.mainShortcuts.numbers,Focus on an open panel (1 being leftmost),1,Concentrer sur un panneau ouvert (1 Actant le plus Aï¿½ gauche),0\\nkeyboardnav.mainShortcuts.escape,Clear the chain or close the focused panel,1,Vider la chaAne ou fermer le panneau en focus,0\\nkeyboardnav.mainShortcuts.start,Start or reset fixture shortcuts,1,DAmarrer ou rA\\\\\\\"initialiser les raccourcis de module,0\\nkeyboardnav.mainShortcuts.backspace,Remove the last key in the chain,1,Retirer la derniA\\\\\\\"re touche de la chaAne,0\\nkeyboardnav.chain.help,Toggle shortcut guide,1,Afficher ou masquer le guide des raccourcis,0\\n\"","<template>\n    <div\n        v-if=\"helpVisible\"\n        ref=\"overlayRef\"\n        class=\"absolute inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 transition-opacity pointer-events-auto\"\n        tabindex=\"-1\"\n        @click=\"handleOverlayClick\"\n    >\n        <div\n            class=\"relative w-[640px] max-h-[80vh] overflow-y-auto rounded-xl bg-white py-8 px-10 shadow-xl\"\n            role=\"dialog\"\n            aria-modal=\"true\"\n            aria-live=\"polite\"\n        >\n            <button\n                type=\"button\"\n                class=\"absolute right-8 top-8 rounded px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\"\n                @click=\"closeHelp\"\n            >\n                {{ t('panels.controls.close') }}\n            </button>\n            <div class=\"border-b border-gray-200 bg-white px-4 py-20 sm:px-24\">\n                <h3 class=\"text-base font-semibold text-gray-900\">{{ t('keyboardnav.helpTitle') }}</h3>\n                <div v-html=\"t('keyboardnav.helpDescription')\" class=\"mt-6 text-sm text-gray-500\"></div>\n            </div>\n            <ul\n                role=\"list\"\n                class=\"m-0 max-w-[calc(var(--container-lg)-(--spacing(8)))] list-none divide-y divide-zinc-900/5 p-0 dark:divide-white/5\"\n            >\n                <li class=\"pl-24 mb-8 py-16\">\n                    <div class=\"flex items-center gap-x-12\">\n                        <span class=\"font-mono text-md text-zinc-600\">\n                            {{ t('keyboardnav.mainShortcuts.title') }}\n                        </span>\n                    </div>\n\n                    <div class=\"space-y-4 p-16 pl-24\">\n                        <div class=\"flex items-center gap-x-12\">\n                            <span\n                                class=\"font-mono px-6 text-[0.825rem]/6 font-semibold rounded-lg px-1.5 ring-1 ring-inset ring-zinc-300 bg-zinc-400/10 text-zinc-500 dark:ring-zinc-400/30 dark:bg-zinc-400/10 dark:text-zinc-400\"\n                            >\n                                1-5\n                            </span>\n                            <span class=\"h-2 w-2 rounded-full bg-zinc-300 dark:bg-zinc-600\"></span>\n                            <span class=\"font-mono text-md text-zinc-600\">\n                                {{ t('keyboardnav.mainShortcuts.numbers') }}\n                            </span>\n                        </div>\n                        <div class=\"flex items-center gap-x-12\">\n                            <span\n                                class=\"font-mono px-6 text-[0.825rem]/6 font-semibold rounded-lg px-1.5 ring-1 ring-inset ring-zinc-300 bg-zinc-400/10 text-zinc-500 dark:ring-zinc-400/30 dark:bg-zinc-400/10 dark:text-zinc-400\"\n                            >\n                                ESC\n                            </span>\n                            <span class=\"h-2 w-2 rounded-full bg-zinc-300 dark:bg-zinc-600\"></span>\n                            <span class=\"font-mono text-md text-zinc-600\">\n                                {{ t('keyboardnav.mainShortcuts.escape') }}\n                            </span>\n                        </div>\n                        <div class=\"flex items-center gap-x-12\">\n                            <span\n                                class=\"font-mono px-6 text-[0.825rem]/6 font-semibold rounded-lg px-1.5 ring-1 ring-inset ring-zinc-300 bg-zinc-400/10 text-zinc-500 dark:ring-zinc-400/30 dark:bg-zinc-400/10 dark:text-zinc-400\"\n                            >\n                                S\n                            </span>\n                            <span class=\"h-2 w-2 rounded-full bg-zinc-300 dark:bg-zinc-600\"></span>\n                            <span class=\"font-mono text-md text-zinc-600\">\n                                {{ t('keyboardnav.mainShortcuts.start') }}\n                            </span>\n                        </div>\n                        <div class=\"flex items-center gap-x-12\">\n                            <span\n                                class=\"font-mono px-6 text-[0.825rem]/6 font-semibold rounded-lg px-1.5 ring-1 ring-inset ring-zinc-300 bg-zinc-400/10 text-zinc-500 dark:ring-zinc-400/30 dark:bg-zinc-400/10 dark:text-zinc-400\"\n                            >\n                                Backspace\n                            </span>\n                            <span class=\"h-2 w-2 rounded-full bg-zinc-300 dark:bg-zinc-600\"></span>\n                            <span class=\"font-mono text-md text-zinc-600\">\n                                {{ t('keyboardnav.mainShortcuts.backspace') }}\n                            </span>\n                        </div>\n                    </div>\n                </li>\n                <li v-if=\"namespaceEntries.length === 0\" class=\"pl-24 mb-8 py-16 border-b\">\n                    <p class=\"font-mono text-md text-zinc-600\">\n                        {{ t('keyboardnav.noShortcuts') }}\n                    </p>\n                </li>\n                <li v-for=\"entry in namespaceEntries\" :key=\"entry.id\" class=\"pl-24 mb-8 py-16 border-b\">\n                    <div\n                        class=\"flex items-center gap-x-12\"\n                        :class=\"{ 'opacity-60': activeNamespace && activeNamespace !== entry.id }\"\n                    >\n                        <div class=\"flex items-center gap-x-4\">\n                            <span\n                                class=\"font-mono px-6 text-[0.825rem]/6 font-semibold rounded-lg px-1.5 ring-1 ring-inset ring-zinc-300 bg-zinc-400/10 text-zinc-500 dark:ring-zinc-400/30 dark:bg-zinc-400/10 dark:text-zinc-400\"\n                                >S</span\n                            >\n                            <span\n                                class=\"font-mono px-6 text-[0.825rem]/6 font-semibold rounded-lg px-1.5 ring-1 ring-inset ring-zinc-300 bg-zinc-400/10 text-zinc-500 dark:ring-zinc-400/30 dark:bg-zinc-400/10 dark:text-zinc-400\"\n                                >{{ entry.id }}</span\n                            >\n                        </div>\n                        <span class=\"h-2 w-2 rounded-full bg-zinc-300 dark:bg-zinc-600\"></span>\n                        <span class=\"font-mono text-md text-zinc-600\">\n                            {{ t(`keyboardnav.ns.${entry.id}`) }}\n                        </span>\n                    </div>\n\n                    <div v-if=\"entry.keys.length\" class=\"space-y-4 p-16 pl-24\">\n                        <div v-for=\"item in entry.keys\" :key=\"item.key\" class=\"flex items-center gap-x-12\">\n                            <div class=\"flex items-center gap-x-4\">\n                                <span\n                                    class=\"font-mono px-6 text-[0.825rem]/6 font-semibold rounded-lg px-1.5 ring-1 ring-inset ring-zinc-300 bg-zinc-400/10 text-zinc-500 dark:ring-zinc-400/30 dark:bg-zinc-400/10 dark:text-zinc-400\"\n                                    >{{ item.key }}</span\n                                >\n                            </div>\n                            <span class=\"h-2 w-2 rounded-full bg-zinc-300 dark:bg-zinc-600\"></span>\n                            <span class=\"font-mono text-md text-zinc-600\">\n                                {{ t(`keyboardnav.key.${entry.id}.${item.key}`) }}\n                            </span>\n                        </div>\n                    </div>\n                </li>\n            </ul>\n        </div>\n    </div>\n</template>\n<script setup lang=\"ts\">\nimport { storeToRefs } from 'pinia';\nimport { useKeyboardnavStore } from './store/keyboardnav-store';\nimport { computed, useTemplateRef, watch, onBeforeUnmount } from 'vue';\nimport { useI18n } from 'vue-i18n';\n\nconst store = useKeyboardnavStore();\nconst { activeNamespace, namespaces, helpVisible } = storeToRefs(store);\nconst { t } = useI18n();\n\nconst namespaceEntries = computed(() =>\n    Object.entries(namespaces.value).map(([id, options]) => ({\n        id,\n        keys: options?.keys ?? []\n    }))\n);\n\nconst overlayRef = useTemplateRef('overlayRef');\nfunction closeHelp() {\n    store.setHelpVisible(false);\n    store.resetChain({ suppressHandler: true });\n}\n\nfunction handleFocusIn(e: FocusEvent) {\n    const target = e.target as Node | null;\n    if (overlayRef.value && target && !overlayRef.value.contains(target)) {\n        closeHelp();\n    }\n}\n\nfunction handleOverlayClick(e: MouseEvent) {\n    // If the click is directly on the overlay (dark background) and not on the dialog\n    if (e.target === e.currentTarget) {\n        closeHelp();\n    }\n}\n\nwatch(helpVisible, val => {\n    if (val) {\n        document.addEventListener('focusin', handleFocusIn);\n    } else {\n        document.removeEventListener('focusin', handleFocusIn);\n    }\n});\n\nonBeforeUnmount(() => {\n    document.removeEventListener('focusin', handleFocusIn);\n});\n</script>\n\n<style lang=\"scss\">\n.key {\n    @apply contents font-mono px-6 text-[0.825rem]/6 font-semibold rounded-lg ring-1 ring-inset;\n\n    &.indigo {\n        @apply ring-indigo-300 bg-indigo-400/10 text-indigo-500 dark:ring-indigo-400/30 dark:bg-indigo-400/10 dark:text-indigo-400;\n    }\n\n    &.zinc {\n        @apply ring-zinc-300 bg-zinc-400/10 text-zinc-500 dark:ring-zinc-400/30 dark:bg-zinc-400/10 dark:text-zinc-400;\n    }\n}\n</style>\n","import { FixtureInstance } from '@/api';\nimport { useKeyboardnavStore } from '../store/keyboardnav-store';\nimport type { NamespaceRegistration } from '../store/keyboardnav-store';\nimport { ROOT_KEY, HELP_NAMESPACE } from '../constants';\n\n/**\n * @internal\n */\nexport class KeyboardnavAPI extends FixtureInstance {\n    private keyboardnavStore = useKeyboardnavStore(this.$vApp.$pinia);\n    private _isInput(target: EventTarget | null): boolean {\n        if (!target || !(target instanceof HTMLElement)) return false;\n        return !!target.closest('input, textarea, [contenteditable=\"true\"]');\n    }\n\n    /**\n     * Register a namespace letter and its keyboard options.\n     *\n     * @param namespace requested namespace letter.\n     * @param options registration object describing keys and handlers.\n     * @returns final namespace letter used for registration.\n     */\n    register(namespace: string, options: NamespaceRegistration): string {\n        const ns = namespace.toUpperCase();\n        const finalNs = this.keyboardnavStore.register(ns, options);\n        const key = `keyboardnav.ns.${finalNs}`;\n        Object.entries(options.name).forEach(([lang, val]) => {\n            (<any>this.$iApi.$i18n).mergeLocaleMessage(lang, { [key]: val });\n        });\n        options.keys.forEach(k => {\n            const kKey = `keyboardnav.key.${finalNs}.${k.key}`;\n            Object.entries(k.description).forEach(([lang, val]) => {\n                (<any>this.$iApi.$i18n).mergeLocaleMessage(lang, { [kKey]: val });\n            });\n        });\n        return finalNs;\n    }\n\n    /** @internal */\n    added(): void {\n        const root = this.$iApi.$rootEl as HTMLElement | null;\n        root?.addEventListener('keydown', this._handleKeyDown);\n        root?.addEventListener('blur', this._handleBlur);\n    }\n\n    /** @internal */\n    removed(): void {\n        const root = this.$iApi.$rootEl as HTMLElement | null;\n        root?.removeEventListener('keydown', this._handleKeyDown);\n        root?.removeEventListener('blur', this._handleBlur);\n    }\n\n    private _handleKeyDown = (event: Event): void => {\n        if (!(event instanceof KeyboardEvent)) return;\n        const e = event;\n        if (this._isInput(e.target)) return;\n\n        const store = this.keyboardnavStore;\n        const chain = store.keyChain;\n        const hasModifier = e.altKey || e.ctrlKey || e.metaKey;\n\n        if (!e.shiftKey && !hasModifier) {\n            if (!chain.length && /^[1-5]$/.test(e.key)) {\n                const idx = parseInt(e.key, 10) - 1;\n                const panel = this.$iApi.panel.visible[idx];\n                if (panel) {\n                    e.preventDefault();\n                    this.$iApi.panel.focus(panel);\n                }\n                return;\n            }\n        }\n\n        const rawKey = e.key;\n        const key = rawKey.length === 1 ? rawKey.toUpperCase() : rawKey;\n\n        if (!hasModifier && key === 'Escape' && store.helpVisible) {\n            e.preventDefault();\n            store.setHelpVisible(false);\n            store.resetChain({ suppressHandler: true });\n            return;\n        }\n\n        if (!e.shiftKey && !hasModifier && key === ROOT_KEY) {\n            e.preventDefault();\n            const suppressHandler = store.chainState === 'complete';\n            store.resetChain({ suppressHandler });\n            store.setChain([ROOT_KEY]);\n            store.setLastAction(null);\n            store.setChainState('awaitNamespace');\n            return;\n        }\n\n        if (store.chainState === 'idle') {\n            if (key === 'Escape' && !e.shiftKey && !hasModifier) {\n                const target = e.target as HTMLElement;\n                const container = target.closest('[data-cy]') as HTMLElement | null;\n                if (container && this.$iApi.$rootEl?.querySelector('.panel-container')?.contains(container)) {\n                    e.preventDefault();\n                    const id = container.getAttribute('data-cy');\n                    if (id) {\n                        this.$iApi.panel.close(id);\n                    }\n                }\n            }\n            return;\n        }\n\n        if (key === 'Escape') {\n            e.preventDefault();\n            store.resetChain({ event: e });\n            return;\n        }\n\n        if (key === 'Backspace') {\n            if (!chain.length) return;\n            e.preventDefault();\n            const previousState = store.chainState;\n            store.setLastAction(null);\n            store.popChain();\n\n            if (!store.keyChain.length) {\n                store.resetChain({ suppressHandler: true });\n                return;\n            }\n\n            if (store.keyChain.length === 1) {\n                store.setChainState('awaitNamespace');\n                store.deactivate(e);\n                return;\n            }\n\n            if (store.keyChain.length === 2) {\n                store.setChainState('awaitAction');\n                const namespaceKey = store.keyChain[1];\n                if (previousState === 'complete' && namespaceKey) {\n                    store.activate(namespaceKey, e, { suppressHandler: false });\n                }\n                return;\n            }\n\n            return;\n        }\n\n        if (e.shiftKey || hasModifier) {\n            return;\n        }\n\n        if (store.chainState === 'awaitNamespace') {\n            const namespaces = Object.keys(store.namespaces);\n\n            if (key === 'H') {\n                e.preventDefault();\n                store.appendKey('H');\n                store.setLastAction({ namespace: HELP_NAMESPACE, key: 'H' });\n                store.finalizeChain({ event: e });\n                store.setHelpVisible(!store.helpVisible);\n                return;\n            }\n\n            if (namespaces.includes(key)) {\n                e.preventDefault();\n                store.appendKey(key);\n                store.setLastAction(null);\n                store.activate(key, e);\n                store.setChainState('awaitAction');\n                return;\n            }\n\n            return;\n        }\n\n        if (store.chainState === 'awaitAction') {\n            const namespaceKey = store.activeNamespace ?? (chain[1] || '');\n            const namespace = store.namespaces[namespaceKey];\n            if (!namespace) {\n                store.resetChain({ suppressHandler: true });\n                return;\n            }\n\n            const validKeys = namespace.keys.map(item => item.key.toUpperCase());\n            if (!validKeys.includes(key)) {\n                return;\n            }\n\n            e.preventDefault();\n            store.appendKey(key);\n            const action = store.trigger(key, e);\n            if (action?.chainAction) {\n                return;\n            }\n            if (action) {\n                store.setLastAction(action);\n            }\n            store.finalizeChain({ event: e });\n            return;\n        }\n    };\n\n    private _handleBlur = (): void => {\n        this.keyboardnavStore.resetChain();\n        this.keyboardnavStore.setHelpVisible(false);\n    };\n}\n","import messages from './lang/lang.csv?raw';\nimport KeyboardnavV from './keyboardnav.vue';\nimport { KeyboardnavAPI } from './api/keyboardnav';\nimport { useKeyboardnavStore } from './store/keyboardnav-store';\n\n/**\n * Keyboard Navigation Fixture\n *\n * Enables registration of namespace shortcuts (ALT+SHIFT+[Letter]) and\n * subsequent SHIFT+[Letter] shortcuts within the active namespace.\n */\nclass KeyboardnavFixture extends KeyboardnavAPI {\n  added(): void {\n    // merge translations\n    Object.entries(messages).forEach(value =>\n      (<any>this.$iApi.$i18n).mergeLocaleMessage(...value)\n    );\n\n    const { destroy, el } = this.mount(KeyboardnavV, {\n      app: this.$element\n    });\n    const innerShell = this.$vApp.$el.getElementsByClassName('inner-shell')[0];\n    innerShell.appendChild(el.childNodes[0]);\n\n    super.added();\n\n    this.removed = () => {\n      super.removed();\n      destroy();\n      useKeyboardnavStore(this.$vApp.$pinia).$reset();\n    };\n  }\n}\n\nexport default KeyboardnavFixture;"],"names":["messages","store","useKeyboardnavStore","activeNamespace","namespaces","helpVisible","storeToRefs","t","useI18n","namespaceEntries","computed","id","options","overlayRef","useTemplateRef","closeHelp","handleFocusIn","e","target","handleOverlayClick","watch","val","onBeforeUnmount","KeyboardnavAPI","FixtureInstance","namespace","ns","finalNs","key","lang","k","kKey","root","event","chain","hasModifier","idx","panel","rawKey","ROOT_KEY","suppressHandler","container","previousState","namespaceKey","HELP_NAMESPACE","item","action","KeyboardnavFixture","value","destroy","el","KeyboardnavV"],"mappings":"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"}