const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./point-icon-03wzGbvg.js","./main-sd5p277L.js","./preload-helper-DMGCcr4D.js","./main-BA8alBZp.css","./polyline-icon-QbKv-KMP.js","./polygon-icon-DdY_NtUU.js","./circle-icon-Cn9u3-Mu.js","./rectangle-icon-CJXTwVNA.js","./edit-icon-D_iGVHql.js"])))=>i.map(i=>d[i]);
import{dr as F,ds as r,dt as t,eM as V,eN as S,f4 as D,jU as H,eT as N,fb as x,eU as v,eV as C,du as u,e$ as G,gl as f,fc as g,eQ as I,eZ as T,eX as O,eW as M,eS as b,jL as L,hv as U,aa as $,gn as P,f3 as X,jV as J,f5 as K,eR as R,f6 as w,eY as j,F as ee,f9 as te}from"./main-sd5p277L.js";import{_ as y}from"./preload-helper-DMGCcr4D.js";import{u as oe}from"./draw-store-BOF6lJ2C.js";const ne={},ae={class:"border-b p-0 self-center w-2/3"};function se(_,a){return t(),r("span",ae)}const W=F(ne,[["render",se]]),ie=V({__name:"zoom-nav",setup(_){const{t:a}=S(),o=D("iApi"),e=H(400,!0,()=>o.geo.map.zoomIn()),c=H(400,!0,()=>o.geo.map.zoomOut());return(s,n)=>{const l=N("mapnav-button");return t(),r("div",null,[x(l,{onClickFunction:v(e),tooltip:v(a)("mapnav.zoomIn")},{default:C(()=>n[0]||(n[0]=[u("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",class:"fill-current w-32 h-20"},[u("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),u("path",{d:"M0 0h24v24H0z",fill:"none"})],-1)])),_:1},8,["onClickFunction","tooltip"]),x(W),x(l,{onClickFunction:v(c),tooltip:v(a)("mapnav.zoomOut")},{default:C(()=>n[1]||(n[1]=[u("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",class:"fill-current w-32 h-20"},[u("path",{d:"M19 13H5v-2h14v2z"}),u("path",{d:"M0 0h24v24H0z",fill:"none"})],-1)])),_:1},8,["onClickFunction","tooltip"])])}}}),re=V({__name:"draw-nav-section",props:{showOutline:{type:Boolean,default:!1}},setup(_){const a=D("iApi"),{t:o}=S(),e=oe();e.mapNavEl=G("mapNavEl");const c=[{type:"point",icon:f(g(()=>y(()=>import("./point-icon-03wzGbvg.js"),__vite__mapDeps([0,1,2,3]),import.meta.url)))},{type:"polyline",icon:f(g(()=>y(()=>import("./polyline-icon-QbKv-KMP.js"),__vite__mapDeps([4,1,2,3]),import.meta.url)))},{type:"polygon",icon:f(g(()=>y(()=>import("./polygon-icon-DdY_NtUU.js"),__vite__mapDeps([5,1,2,3]),import.meta.url)))},{type:"circle",icon:f(g(()=>y(()=>import("./circle-icon-Cn9u3-Mu.js"),__vite__mapDeps([6,1,2,3]),import.meta.url)))},{type:"rectangle",icon:f(g(()=>y(()=>import("./rectangle-icon-CJXTwVNA.js"),__vite__mapDeps([7,1,2,3]),import.meta.url)))}],s=I(()=>{const i=c.filter(m=>e.supportedTypes.some(E=>E.type===m.type));return i.push({type:"edit",icon:f(g(()=>y(()=>import("./edit-icon-D_iGVHql.js"),__vite__mapDeps([8,1,2,3]),import.meta.url)))}),i}),n=i=>{e.activeTool===i?e.setActiveTool(null):e.setActiveTool(i)},l=()=>{a.geo.map.setMouseFocus()};return(i,m)=>{const E=N("mapnav-button");return t(),r("div",{class:T([{active:v(e).activeTool||v(e).activeTool==""},"mapnav-section bg-white-75 hover:bg-white"])},[(t(!0),r(O,null,M(s.value,(d,A)=>(t(),b(E,{key:d.type,onMousedown:l,onClickFunction:()=>n(d.type),tooltip:v(o)(`draw.${d.type}.tooltip`),style:U({marginBottom:A!==s.value.length-1?"0px":"0"}),showOutline:_.showOutline,class:T({"active-tool":v(e).activeTool===d.type}),ref_for:!0,ref:"mapNavEl"},{default:C(()=>[(t(),b(L(d.icon),{class:"fill-current w-32 h-20"}))]),_:2},1032,["onClickFunction","tooltip","style","showOutline","class"]))),128))],2)}}}),Z=F(re,[["__scopeId","data-v-33fb7158"]]),le={class:"mapnav absolute right-0 bottom-0 pb-36 sm:pb-48 pr-12"},ce=["content"],pe={class:"mapnav-section bg-white-75 hover:bg-white"},ue={key:1,class:"mapnav-section bg-white-75 hover:bg-white"},ve=["content"],me={key:0},de=V({__name:"mapnav",setup(_){const a=$(void 0),o=D("iApi"),e=P(),{t:c}=S(),s=$(),n=I(()=>o.getConfig().fixtures.mapnav.items.some(p=>p==="draw")),l=$(o.$rootEl?.clientHeight),i=$(!1),m=$(0),E=()=>{l.value=o.$rootEl?.clientHeight},d=()=>{s.value._tippy.hide()},A=p=>{p.key==="Tab"&&s.value?.matches(":focus")&&s.value._tippy.show()};X(()=>{s.value?.addEventListener("blur",d),s.value?.addEventListener("keyup",A),a.value=new ResizeObserver(E),a.value.observe(o.$rootEl),J(()=>{m.value=z.value.length*82})}),K(()=>{s.value?.removeEventListener("blur",d),s.value?.removeEventListener("keyup",A),a.value.disconnect()});const z=I(()=>e.order.map(p=>e.items[p]).filter(p=>p.componentId&&p.id!=="draw"));return(p,h)=>{const Y=N("mapnav-button"),Q=j("focus-list"),B=j("tippy");return t(),r("div",le,[R((t(),r("div",{class:"mapnav-section flex flex-col",content:v(c)("panels.controls.items"),ref_key:"el",ref:s},[n.value&&l.value>m.value?(t(),r(O,{key:0},[x(Z),h[0]||(h[0]=u("span",{class:"py-1"},null,-1))],64)):w("",!0),x(ie,{class:"mapnav-section bg-white-75 hover:bg-white"}),h[2]||(h[2]=u("span",{class:"py-1"},null,-1)),u("div",pe,[l.value<=m.value?(t(),b(Y,{key:0,class:"self-center",onClickFunction:()=>{i.value=!i.value},tooltip:i.value?p.$t("mapnav.closeMenu"):p.$t("mapnav.openMenu")},{default:C(()=>[(t(),r("svg",{xmlns:"http://www.w3.org/2000/svg","shape-rendering":"geometricPrecision","text-rendering":"geometricPrecision","image-rendering":"optimizeQuality","fill-rule":"evenodd","clip-rule":"evenodd",viewBox:"0 0 319 511.61",class:T(["fill-current w-6 mx-auto transition-all transform",{"rotate-180":i.value}])},h[1]||(h[1]=[u("path",{d:"m270.08 5.89 43.04 43.04c7.85 7.86 7.83 20.72 0 28.54L134.77 255.82l178.35 178.35c7.85 7.86 7.8 20.73 0 28.54l-43.04 43.04c-7.83 7.82-20.71 7.82-28.54 0L49.29 313.49l-.37-.36-43.04-43.04c-7.82-7.83-7.86-20.68 0-28.54l43.04-43.04.37-.36L241.54 5.89c7.85-7.85 20.68-7.85 28.54 0z"},null,-1)]),2))]),_:1},8,["onClickFunction","tooltip"])):w("",!0)]),l.value>m.value?(t(),r("div",ue,[(t(!0),r(O,null,M(z.value,(k,q)=>(t(),r(O,{key:k.id+"button"},[(t(),b(L(k.id+"-nav-button"))),q!==z.value.length-1?(t(),b(W,{key:0,class:"mapnav-divider"})):w("",!0)],64))),128))])):w("",!0)],8,ce)),[[Q],[B,{trigger:"manual",placement:"top-end",touch:!1,maxWidth:190}]]),l.value<=m.value&&i.value?R((t(),r("div",{key:0,class:"mapnav-section flex flex-col flex-wrap-reverse shadow-tm absolute right-56 bottom-36 sm:bottom-48 items-start z-50 gap-0.5",style:U({maxHeight:`${(l.value-70)*.8}px`,height:"fit-content",width:"fit-content"}),content:v(c)("panels.controls.items")},[n.value?(t(),r("div",me,[x(Z,{showOutline:""})])):w("",!0),(t(!0),r(O,null,M(z.value,k=>(t(),b(L(k.id+"-nav-button"),{key:k.id+"button",class:"mapnav-section bg-white-75 hover:bg-white",showOutline:""}))),128))],12,ve)),[[B,{trigger:"manual",placement:"top-end",maxWidth:190}]]):w("",!0)])}}}),he=F(de,[["__scopeId","data-v-b75ec8de"]]);class _e extends ee{mapnavStore=P(this.$vApp.$pinia);get config(){return super.config}_parseConfig(a){if(!a)return;const o=a.items.map(e=>({id:e}));this.mapnavStore.items=o.reduce((e,c)=>(e[c.id]=c,e),{}),this.mapnavStore.order=o.map(e=>e.id),this._validateItems()}_validateItems(){const a=["geolocator","zoom","home","fullscreen"];this.mapnavStore.order.forEach(o=>{(this.$iApi.fixture.exists(o)||a.includes(o))&&(this.mapnavStore.items[o].componentId=`${o}-nav-button`)})}}const fe={en:{"mapnav.openMenu":"Open navigation","mapnav.closeMenu":"Close navigation","mapnav.zoomIn":"Zoom In","mapnav.zoomOut":"Zoom Out","mapnav.home":"Home","mapnav.fullscreen":"Full Screen","mapnav.geolocator":"Your Location","mapnav.geolocator.error.permission":"The location request was denied. Please check your browser permission settings.","mapnav.geolocator.error.internal":"Your location could not be found."},fr:{"mapnav.openMenu":"Ouvrir la navigation","mapnav.closeMenu":"Fermer la navigation","mapnav.zoomIn":"Zoom avant","mapnav.zoomOut":"Zoom arrière","mapnav.home":"Accueil","mapnav.fullscreen":"Plein Écran","mapnav.geolocator":"Votre position","mapnav.geolocator.error.permission":"Demande de localisation refusée. Veuillez vérifier les paramètres d'autorisation de votre navigateur.","mapnav.geolocator.error.internal":"Votre emplacement n'a pu être trouvé."}};class be extends _e{async added(){Object.entries(fe).forEach(n=>this.$iApi.$i18n.mergeLocaleMessage(...n));const{destroy:a,el:o}=this.mount(he,{app:this.$element});this.$vApp.$el.getElementsByClassName("inner-shell")[0].appendChild(o.childNodes[0]),this._parseConfig(this.config);const c=this.$vApp.$watch(()=>this.config,n=>this._parseConfig(n)),s=this.$iApi.event.on(te.COMPONENT,()=>{this._parseConfig(this.config)});this.removed=()=>{c(),this.$iApi.event.off(s);const n=P(this.$vApp.$pinia),l={...n.items};Object.keys(l).forEach(i=>n.removeItem(i)),n.$reset(),a()}}}export{be as default};
